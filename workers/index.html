<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link rel="stylesheet" href="../style/pixelless.css" type="text/css"/>
    <title>Webworker</title>
    <style type="text/css">
	    #out	{
		    text-shadow: 0 0.05em .1em #000;
	    }

	    .holder
	    {
		    width: 100%;
		    border: 1px solid;
		    text-align: center;
	    }

	    .filled
	    {
		    overflow: hidden;
	    }

	    .empty
	    {
		    text-shadow: 0 0.05em .1em #000;
	    }

	    .progress
	    {
		    background-color: #eee;
		    color:#232323;
		    text-shadow: 0 0.05em .1em #fff;
	    }
    </style>
</head>
<body>
<div id="container">
    <div class="content header">
        <h1>Webworker</h1>
    </div>

    <div class="content">
	<div class="holder">
		<div class="empty" id="empty">0.00 %</div>
		<div class="filled" id="filled">
			<div class="progress" id="progress">0.00 %</div>
		</div>
	</div>
	<div id="out"></div>
        <div class="empty_footer">
        </div>
    </div>
</div>
<div id="footer">
    <div class="content">
        &copy; 2010 Vynogradov
    </div>
</div>
<script type="text/javascript" language="JavaScript">
	var worker = new Worker('script/work.js');

	var out = document.getElementById('out');

	var empty = document.getElementById('empty');
	var filled = document.getElementById('filled');
	var progress = document.getElementById('progress');
	progress.style.width = empty.clientWidth + 'px';
	filled.style.marginTop = '-' + empty.clientHeight + 'px';

	worker.onmessage = function(event)
	{
		var progressPct = event.data * 100;
		var data = progressPct.toFixed(2) + ' %';

		out.innerHTML = data;
		empty.innerHTML = data;
		progress.innerHTML = data;
		filled.style.width = progressPct + '%';

		empty.width = progressPct + '%';
	}
</script>
</body>
</html>
