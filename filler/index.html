<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link rel="stylesheet" href="../style/pixelless.css" type="text/css"/>
    <title>Filler</title>
    <script type="text/javascript" src="../script/util.js"></script>
    <script type="text/javascript" src="../script/canvas.js"></script>
    <script type="text/javascript" src="../script/color.js"></script>
    <script type="text/javascript" src="script/logic.js"></script>
    <script type="text/javascript" src="script/presentation.js"></script>
    <style type="text/css">
        html, body {
            background-color: #262626;
        }

        #colors {
            font-size: 170%;
            float: left;
            width: 3.5em;
        }

        .color-control {
            text-decoration: none;
            height: 2.2em;
            width: 2em;
            display: inline-block;
            padding-left: .2em;
            color: #484848;
            font-family: Tahoma, sans-serif;
            border: .15em solid;
            margin: .3em;
        }

    </style>
</head>
<body>
<div id="container">
    <div class="content header">
        <h1>Filler</h1>
    </div>

    <div class="content">
        <div id="colors"></div>
        <canvas id="main-filler-canvas" width="800px" height="500px"></canvas>

        <div class="emtpy_footer">
        </div>
    </div>
</div>
<div id="footer">
    <div class="content">
        &copy; Vynogradov 2009
    </div>
</div>
<script type="text/javascript">
    var canvasId = 'main-filler-canvas';
    var canvas = document.getElementById(canvasId);

    var filler = new Filler(canvas);
//    filler.render();

    var control_holder = document.getElementById('colors');
    var colors = filler.getColors();

    var controlTmp = '<a href="#color{n}" class="color-control color-{n}">{n}</a>';
    var styleTmp =
            '.color-{n} {background-color: {color}; border-color: {light} {dark} {dark} {light}; color: {text-color}}\n'
                    + '.color-{n}:hover, .color-{n}:visited, .color-{n}:visited:hover {color: {text-color}}\n'
                    + '.color-{n}:hover, .color-{n}:visited:hover {background-color: {light}}';

    function generateControl( colorStr, n )
    {
        return controlTmp.fmt({n:n + 1});
    }

    function generateStyle( colorStr, n )
    {
        var color = new Color(colorStr);
        var textColor = ((color.red + color.green + color.blue) / 3 + 128) % 256 < 128 ? '#262626' : '#e0e0e0';
        return styleTmp.fmt({n:n + 1, color:color.tint(-20), light:color.tint(40), dark:color.tint(-55), 'text-color':textColor});
    }

    control_holder.innerHTML =
    [
        '<style type="text/css">'
        , colors.map(generateStyle).join('\n')
        , '</style>'
        , colors.map(generateControl).join('')
    ].join('');


</script>
</body>
</html>
