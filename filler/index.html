<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link rel="stylesheet" href="../style/pixelless.css" type="text/css"/>
    <title>Filler</title>
    <script type="text/javascript" src="../script/util.js"></script>
    <script type="text/javascript" src="../script/canvas.js"></script>
    <script type="text/javascript" src="../script/color.js"></script>
    <script type="text/javascript" src="script/logic.js"></script>
    <script type="text/javascript" src="script/presentation.js"></script>
    <style type="text/css">
        html, body {
            background-color: #262626;
        }

        #colors {
            float: left;
            width: 3.2em;
            margin: 1em;
            padding-top: .5em;
        }

        #colors input {
            height: 3.2em;
            width: 3.2em;
            border: .2em solid;
            margin-bottom: 1em; 
        }

    </style>
</head>
<body>
<div id="container">
    <div class="content header">
        <h1>Filler</h1>
    </div>

    <div class="content">
        <div id="colors"></div>
        <canvas id="main-filler-canvas" width="800px" height="500px"></canvas>

        <div class="emtpy_footer">
        </div>
    </div>
</div>
<div id="footer">
    <div class="content">
        &copy; Vynogradov 2009
    </div>
</div>
<script type="text/javascript">
    var styleTmp = 'background-color: {color}; border-color: {hi-col} {low-col} {low-col} {hi-col}';
    var inputTmp = '<input type="button" class="color-control" id="color-{index}" style="{style}" value=""/>';

    var canvasId = 'main-filler-canvas';
    var canvas = document.getElementById(canvasId);

    var filler = new Filler(canvas);
    filler.render();


             var i=j=2;
     var x = j * filler.dx;
    var y = i * filler.dy;

    filler.ctx.fillStyle = 'black';
    filler.ctx.globalCompositeOperation     ='destination-out';

    filler.ctx
            .save()
            .translate(x + (i % 2 + 1) * filler.dx / 2 + filler.width * (1 - margin) / 2, filler.height - filler.height * (1 - margin ) / 2 - y - filler.dy)
            .beginPath()
            .moveTo(- (1+pad * filler.dx) / 2, 0)
            .lineTo(0,  (1+pad * filler.dy))
            .lineTo((1+pad *  filler.dx) / 2, 0)
            .lineTo(0, - (1+pad * filler.dy)    )
            .closePath()
            .fill()
            .restore();


    var colors = document.getElementById('colors');

    filler.getColors().forEach(
            function( col, i )
            {
                var color = new Color(col);
                var style= styleTmp.fmt({color:col, 'hi-col': color.tint(40), 'low-col':color.tint(-40)});
                colors.innerHTML += inputTmp.fmt({index:i, style:style});
            }
    );
</script>
</body>
</html>
